  ZCGL _DataContext = new ZCGL();

            


            InvokeOperation<string> result = _DataContext.GetStringXmlValue();

            result.Completed += ((p1, q1) =>
            {
                if (result.HasError)
                    return;
                string val = result.Value;

                XmlReader xr = XmlReader.Create(new StringReader(val));                
                //XDocument doc = XDocument.Load(xr);

            // var v=   doc.Descendants("table");

               //var  v= doc.Root.Elements();

              // dgProjectList.ItemsSource = v;

                
                
            });          
                




 public string GetStringXmlValue()
        {

            MemoryStream ms = null;
            XmlTextWriter XmlWt = null;

            ms = new MemoryStream();
            //根据ms实例化XmlWt
            XmlWt = new XmlTextWriter(ms, Encoding.Unicode);
            DataTable dt = new DataTable();
            //查询数据
            DataSet ds = new DataSet();
            string StrConn = "server=192.168.1.210;database=BCM_FZ;uid=sa;pwd=ABCabc123";
            SqlConnection Conn = new SqlConnection(StrConn);
            string strSql = "select * from T_Appl_Info";

            string dataname = "Appl_Info";

            SqlDataAdapter da = new SqlDataAdapter(strSql, Conn);
            Conn.Open();
            da.Fill(ds);
            Conn.Close();
            Conn.Dispose();

            if (ds != null && ds.Tables.Count > 0)
            {
                dt = ds.Tables[0];
                dt.WriteXml(XmlWt);

                int count = (int)ms.Length;
                byte[] temp = new byte[count];
                ms.Seek(0, SeekOrigin.Begin);
                ms.Read(temp, 0, count);
               
                //返回Unicode编码的文本
                UnicodeEncoding ucode = new UnicodeEncoding();
                string returnValue = ucode.GetString(temp).Trim();
                return returnValue;
            }
            return string.Empty;
        }